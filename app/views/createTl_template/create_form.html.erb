<h1>Create a Tier List | Add Item Categories</h1>

<!--Creates custom fields for items in the tier list-->
<%= form_with url: create_field_path, method: :post, local: true do |form| %>
  <div>
    <%= form.label :the_name, "Tier List Name" %>
    <%= form.text_field :the_name, id: "name_field", name: "the_name" %>
  </div>

  <h4>Columns already included for each item</h4>
  <ul>
    <li>Item name</li>
    <li>Item description</li>
  </ul>

  <div id="fields-container">
    <h4>Add additional fields for each item</h4>

    <!-- Loop to generate fields 1 through 5 -->
    <% (1..5).each do |i| %>
      <div class="field">
        <fieldset>
          <legend><h3>Field <%= i %></h3></legend>
          <div>
            <%= form.text_field "field#{i}_name", placeholder: "Enter name", id: "field_#{i}_name", name: "field#{i}_name" %>
            <%= form.select "field#{i}_datatype", [["Select Data Type", ""], ["Text", "Text"], ["Number", "Number"], ["Date", "Date"]], { selected: "" }, name: "field#{i}_datatype" %>
          </div>
        </fieldset>
      </div>
    <% end %>
  </div>

  <!-- Submit Button -->
  <%= form.submit "Submit" %>
<% end %>





<script>
  let fieldCount = 6; // Initial count, assuming fields 1 to 5 exist

  function addField() {
    if (fieldCount > 10) {
      document.getElementById("error-message").textContent = "You can only add up to 10 fields.";
      return;
    }

    const fieldsContainer = document.getElementById('fields-container');
    const templateField = document.querySelector('.field');
    
    if (!templateField) {
      console.error("Template field with class 'field' not found.");
      return;
    }
    
    const newField = templateField.cloneNode(true);
    const legend = newField.querySelector('legend h3');
    legend.textContent = `Field ${fieldCount}`;

    const input = newField.querySelector('input[type="text"]');
    input.id = `field_${fieldCount}`;
    input.name = `field${fieldCount}_name`;
    input.placeholder = "Enter name";
    input.value = "";

    const select = newField.querySelector('select');
    select.name = `field${fieldCount}_datatype`;
    select.selectedIndex = 0;

    fieldsContainer.appendChild(newField);
    fieldCount++;
  }
</script>
